{% extends "PlatiumTrophyTracker_app/base_template.html" %}

{% block content %}
<div class="container">
    <h2>Register</h2>
    <form method="post">
        {% csrf_token %}
        <div class="mb-3">
            <label for="id_username" class="form-label">Name:</label>
            <input type="text" class="form-control" id="id_username" name="name" required>
        </div>
        <div class="mb-3">
            <label for="id_email" class="form-label">Email:</label>
            <input type="email" class="form-control" id="id_email" name="email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
            <div class="invalid-feedback">
                Please enter a valid email address.
            </div>
        </div>
        <div class="mb-3">
            <label for="id_password1" class="form-label">Password:</label>
            <input type="password" class="form-control" id="id_password1" name="password1" required>
            <div id="password1Feedback" class="invalid-feedback" style="display: none;"></div>
        </div>
        <div class="mb-3">
            <label for="id_password2" class="form-label">Confirm Password:</label>
            <input type="password" class="form-control" id="id_password2" name="password2" required pattern="^(?=.*\d)(?=.*[a-zA-Z]).{8,}$" oninput="checkPasswordMatch()">
            <div class="invalid-feedback">
                Passwords must be at least 8 characters long and contain at least one number and one uppercase or lowercase letter.
            </div>
            <div id="password2Feedback" class="invalid-feedback" style="display: none;">Passwords do not match.</div>
        </div>
        <button type="submit" class="btn btn-primary">Register</button>
    </form>
</div>

<script>
    function checkPasswordMatch() {
        var password1 = document.getElementById("id_password1").value;
        var password2 = document.getElementById("id_password2").value;
        if (password1 !== password2) {
            document.getElementById("id_password2").setCustomValidity("Passwords do not match");
            document.getElementById("password2Feedback").style.display = 'block';
        } else {
            document.getElementById("id_password2").setCustomValidity("");
            document.getElementById("password2Feedback").style.display = 'none';
        }

        if (!/(?=.*\d)(?=.*[a-zA-Z]).{8,}/.test(password1)) {
            document.getElementById("id_password1").setCustomValidity("Password must be at least 8 characters long and contain at least one number and one uppercase or lowercase letter.");
            document.getElementById("password1Feedback").innerText = "Password must be at least 8 characters long and contain at least one number and one uppercase or lowercase letter.";
            document.getElementById("password1Feedback").style.display = 'block';
        } else {
            document.getElementById("id_password1").setCustomValidity("");
            document.getElementById("password1Feedback").style.display = 'none';
        }
    }
</script>
{% endblock %}
